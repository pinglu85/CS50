{% extends 'layout.html' %}

{% block title %}
  Change Password
{% endblock %}

{% block main %}
  <form action="/change-password" method="post">
    <div class="form-group">
        <input class="form-control" name="current-password" placeholder="Current password" type="password">
    </div>
    <div class="form-group">
        <input class="form-control" name="new-password" placeholder="New password" type="password">
    </div>
    <div class="form-group">
        <input class="form-control" name="confirmation" placeholder="New password (again)" type="password">
    </div>
    <button class="btn btn-primary" type="submit">Change Password</button>
  </form>

  <script>
    const form = document.querySelector('form');
    const newPasswordField = form.elements['new-password'];

    // Ensure password is at least 6 characters long, contains at least
    // one digit, one uppercase
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      const password = newPasswordField.value;
      const regex = /(?=.{6,})(?=.*\d+.*)(?=.*[A-Z]+.*)(?=.*\W+.*)/;
      if (!regex.test(password)) {
        alert('Password must be at least 6 characters long and contains at least one digit, one uppercase and one symbol.');
      } else {
        this.submit();
      }
    });  
  </script>
{% endblock %}